import{d as Q,r as c,a as k,c as z,b as n,w as ee,e as M,f as s,g as a,h as j,i as I,F as X,E as S,j as te,u as q,p as G,k as J,_ as O,l as ae,m as oe,n as le,q as ne}from"./index-43fa284a.js";import{E as se,a as ie,_ as re}from"./el-table-column-e379039f.js";import{S as w}from"./http-7590b1ae.js";import"./el-col-327ca27f.js";import{C as ce}from"./CPageContainer-285012f3.js";import{C as Y,_ as H}from"./CModalConfirm-8980a40c.js";import{C as de}from"./CModalImport-3ab40182.js";/* empty css                     */import{B as F,_ as K}from"./BaseService-ae473529.js";import{W}from"./WarehouseService-64370991.js";import{P as ue}from"./ProductService-e42bce8b.js";import{v as pe}from"./el-loading-6ec02063.js";import{E as me}from"./el-switch-b511adb2.js";import{E as _e}from"./EImg-f0d9a1a1.js";import{C as he}from"./ConsignmentsService-2d91f76d.js";import{E as fe}from"./index-4dd40978.js";import"./index-45ffb881.js";import"./event-9519ab40.js";import"./validator-183bd9e8.js";import"./index-24f0d954.js";import"./flatten-2355c2af.js";import"./datetime-983c5328.js";import"./datetime-8fa1e943.js";import"./index-b24496e1.js";const L=_=>(G("data-v-2b101b0d"),_=_(),J(),_),ge={class:"tbl"},ve={key:0,class:"tag__action tag__action__red"},ye=L(()=>n("span",null,"Ngừng hoạt động",-1)),be=[ye],Ce={key:1,class:"tag__action tag__action__green"},ke=L(()=>n("span",null," Hoạt động",-1)),Se=[ke],we={class:"d-flex align-items-center justify-center"},xe=["onClick"],Ee=L(()=>n("i",{class:"icon-Edit"},null,-1)),$e=[Ee],Te=["onClick"],Ie=L(()=>n("i",{class:"icon-eye-2"},null,-1)),Le=[Ie],Ae=["onClick"],Ve=L(()=>n("i",{class:"icon-setting-2"},null,-1)),Ne=[Ve],Re=Q({__name:"EmployeesTable",props:{items:{default:()=>[]}},emits:["refresh","select"],setup(_,{expose:D,emit:A}){const y=_,t=c(!1),x=q(),E=c(!1),h=i=>{E.value=i},V=c(),N=i=>{A("select",i)},g=c(null),$=i=>{g.value.open({id:i.id,title:`${t.value?"Kích hoạt":"Hủy kích hoạt"} kho hàng`,message:`Bạn có chắc chắn muốn ${t.value?"kích hoạt":"hủy kích hoạt"} kho hàng <b>${i.name}</b> không?`})},U=async i=>{try{const{code:d}=await W.delete(i);if(d===w)return S({message:`${t.value?"Kích hoạt":"Hủy kích hoạt"} kho hàng thành công`,type:"success"}),A("refresh"),g.value.close()}catch(d){console.log(d)}},b=()=>{t.value=!t.value},R=i=>{x.pushByPath(`/warehouse/form/${i.id}`)},v=i=>{x.pushByPath(`/warehouse/detail/${i.id}`)};return D({changeLoading:h}),(i,d)=>{const r=se,C=te,P=me,T=ie,B=pe;return k(),z(X,null,[n("div",ge,[ee((k(),M(T,{data:y.items,class:"tbl__table",ref_key:"multipleTableRef",ref:V,"row-key":"id",onSelectionChange:N},{default:s(()=>[a(r,{type:"selection",width:"55","reserve-selection":!0}),a(r,{prop:"id",label:"ID",width:"100",align:"center"}),a(r,{prop:"image",label:"Ảnh",width:"205",align:"center"},{default:s(({row:u})=>[u.image?(k(),M(_e,{key:0,class:"form__ecommerce__logo",src:u.image,size:"65px"},null,8,["src"])):j("",!0)]),_:1}),a(r,{prop:"name",label:"Tên kho hàng","min-width":"240",align:"left","header-align":"center"}),a(r,{prop:"code",label:"Mã kho",width:"205",align:"center"}),a(r,{prop:"warehouseType",label:"Loại kho",width:"205",align:"center"}),a(r,{prop:"status",label:"Trạng thái",width:"205",align:"center"},{default:s(({row:u})=>[u.status===2?(k(),z("div",ve,be)):j("",!0),u.status===1?(k(),z("div",Ce,Se)):j("",!0)]),_:1}),a(r,{prop:"persionInCharge",label:"Người phụ trách",width:"205",align:"center"}),a(r,{prop:"createdAt",label:"Ngày tạo",width:"205",align:"center"}),a(r,{prop:"updatedAt",label:"Ngày cập nhật",width:"205",align:"center"}),a(r,{fixed:"right",prop:"action",label:"Hành động",width:"205",align:"center"},{default:s(({row:u})=>[n("div",we,[a(C,{content:"Chỉnh sửa"},{default:s(()=>[n("div",{class:"btn__action btn__action--blue d-flex justify-center align-items-center",onClick:o=>R(u)},$e,8,xe)]),_:2},1024),a(C,{content:"Chi tiết"},{default:s(()=>[n("div",{class:"btn__action btn__action--yellow d-flex justify-center align-items-center mr-8",onClick:o=>v(u)},Le,8,Te)]),_:2},1024),a(C,{content:"Phân quyền"},{default:s(()=>[n("div",{class:"btn__action btn__action--gray d-flex justify-center align-items-center mr-8",onClick:o=>v(u)},Ne,8,Ae)]),_:2},1024),a(C,{content:`${t.value?"Hoạt động":"Ngừng hoạt động"}`,placement:"bottom"},{default:s(()=>[a(P,{onClick:o=>$(u),modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=o=>t.value=o),style:{"--el-switch-on-color":"#13ce66"}},null,8,["onClick","modelValue"])]),_:2},1032,["content"])])]),_:1})]),_:1},8,["data"])),[[B,E.value]])]),a(I(Y),{ref_key:"modalConfirmSwitchRef",ref:g,onConfirm:U,onClose:b},null,512)],64)}}});const Be=O(Re,[["__scopeId","data-v-2b101b0d"]]),m=_=>(G("data-v-9c39b5fc"),_=_(),J(),_),ze={class:"product__content p-16 rounded-sm"},De={class:"product__filter d-flex align-items-center justify-start flex-wrap"},Ue=m(()=>n("i",{class:"product__filter__item__icon icon-Search"},null,-1)),Pe=m(()=>n("i",{class:"icon-Search"},null,-1)),je=m(()=>n("i",{class:"icon-Resset"},null,-1)),He={class:"d-flex align-items-center justify-start mt-4 mb-32"},We=m(()=>n("i",{class:"icon-add-3 mr-4"},null,-1)),Me=m(()=>n("span",null,"Thêm mới",-1)),Fe=m(()=>n("i",{class:"icon-import mr-4"},null,-1)),Ke=m(()=>n("span",null,"Import",-1)),Qe=m(()=>n("i",{class:"icon-export-2 mr-4"},null,-1)),Xe=m(()=>n("span",null,"Export",-1)),qe=m(()=>n("span",null,"Kích hoạt",-1)),Ge=m(()=>n("span",null,"Khóa tài khoản",-1)),Je={class:"d-flex align-items-center justify-end mt-16"},Oe=Q({__name:"EmployeesList",emits:["refresh"],setup(_,{emit:D}){const A=q(),y=c(),t=c({page:1,pageSize:10,key:null,warehouseTypeId:null,status:null,createdAtStart:null,createdAtEnd:null,updateedAtStart:null,updateedAtEnd:null,persionInChargeId:null}),x=c({page:1,pageSize:10,key:"",status:null}),E=c({page:1,pageSize:10,key:"",status:null}),h=ae({staffList:[],warehouseTypeList:[],statusList:[{value:1,label:"Hoạt động"},{value:2,label:"Ngừng hoạt động"}],listData:[],totals:0});oe(async()=>{await Promise.all([g(),R(),U()])});const V=()=>{t.value={page:1,pageSize:t.value.pageSize,key:null,warehouseTypeId:null,status:null,createdAtStart:null,createdAtEnd:null,updateedAtStart:null,updateedAtEnd:null,persionInChargeId:null},g()},N=()=>{t.value.page=1,g()},g=async()=>{try{const o={...t.value,key:t.value.key?t.value.key.trim():""};y.value.changeLoading(!0);const{code:e,data:p}=await W.getList(o);e===w&&(h.listData=p.items,h.totals=p.totalElement,y.value.changeLoading(!1))}catch{y.value.changeLoading(!1),S({message:"Có lỗi xảy ra",type:"error"})}},$=c(!1),U=async o=>{try{$.value=!0,E.value.key=o?o.trim():"";const{code:e,data:p}=await F.getListStaff(E.value);e===w&&(h.staffList=p.items,$.value=!1)}catch{$.value=!1}},b=c(!1),R=async o=>{try{b.value=!0,x.value.key=o?o.trim():"";const{code:e,data:p}=await F.getListWarehouseType(x.value);e===w&&(h.warehouseTypeList=p.items,b.value=!1)}catch{b.value=!1}},v=c([]),i=o=>{v.value=o,console.log("event",v.value)},d=c(),r=()=>{d.value.open({template:"https://assets.icheck.vn/application/2023/app/3/8/3527ce664af73dd7b7ef6501933fa63e.xlsx"})},C=async o=>{var e,p,f;try{(e=d.value)==null||e.changeLoading(!0);const l=new FormData;l.append("file",o[0],o[0].name);const{code:Z}=await ue.import(l);Z===w?(S({message:"Import nhân viên thành công",type:"success"}),(p=d.value)==null||p.close(),await V()):S({title:"Có lỗi xảy ra",message:"Vui lòng thử lại",type:"error"})}catch(l){console.log(l)}finally{(f=d.value)==null||f.changeLoading(!1)}},P=async()=>{try{const o=await W.exportInventoryConsignment(t.value);o&&le(o,"Danh sách tồn kho theo lô hàng")}catch{S({message:"Có lỗi xảy ra",type:"error"})}},T=c(null),B=o=>{T.value.open({id:o.id,title:"Xoá lô hàng",message:`Bạn có chắc chắn muốn xóa lô hàng <b>${o.name}</b> không?`})},u=async o=>{try{const{code:e}=await he.delete(o);if(e===w)return S({message:"Xoá lô hàng thành công",type:"success"}),D("refresh"),T.value.close()}catch(e){console.log(e)}};return(o,e)=>{const p=fe,f=ne;return k(),z(X,null,[a(I(ce),{class:"product",title:"Danh sách nhân viên"},{default:s(()=>[n("div",ze,[n("div",De,[a(p,{class:"product__filter__item mr-8 mb-8",modelValue:t.value.key,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.key=l),placeholder:"Tên nhân viên, mã NV, SĐT"},{prefix:s(()=>[Ue]),_:1},8,["modelValue"]),a(K,{items:h.warehouseTypeList,"item-value":"value","item-label":"label",modelValue:t.value.warehouseTypeId,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.warehouseTypeId=l),class:"product__filter__item mr-8 mb-8",placeholder:"Phòng ban",maxWidth:"300px",remote:!0,filterable:!0,"reserve-keyword":!0,"remote-show-suffix":!0,loading:b.value,remoteMethod:R},null,8,["items","modelValue","loading"]),a(K,{items:h.statusList,"item-value":"value","item-label":"label",modelValue:t.value.status,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.status=l),class:"product__filter__item mr-8 mb-8",placeholder:"Trạng thái",maxWidth:"300px"},null,8,["items","modelValue"]),a(H,{class:"product__filter__item product__filter__item--daterange mr-8 mb-8",from:t.value.createdAtStart,"onUpdate:from":e[3]||(e[3]=l=>t.value.createdAtStart=l),to:t.value.createdAtEnd,"onUpdate:to":e[4]||(e[4]=l=>t.value.createdAtEnd=l),type:"daterange","range-separator":"~","start-placeholder":"Ngày tạo: Từ","end-placeholder":"Đến"},null,8,["from","to"]),a(H,{class:"product__filter__item product__filter__item--daterange mr-8 mb-8",from:t.value.updateedAtStart,"onUpdate:from":e[5]||(e[5]=l=>t.value.updateedAtStart=l),to:t.value.updateedAtEnd,"onUpdate:to":e[6]||(e[6]=l=>t.value.updateedAtEnd=l),type:"daterange","range-separator":"~","start-placeholder":"Ngày bắt đầu HĐ: Từ","end-placeholder":"Đến"},null,8,["from","to"]),a(H,{class:"product__filter__item product__filter__item--daterange mr-8 mb-8",from:t.value.updateedAtStart,"onUpdate:from":e[7]||(e[7]=l=>t.value.updateedAtStart=l),to:t.value.updateedAtEnd,"onUpdate:to":e[8]||(e[8]=l=>t.value.updateedAtEnd=l),type:"daterange","range-separator":"~","start-placeholder":"Ngày kết thúc HĐ: Từ","end-placeholder":"Đến"},null,8,["from","to"]),a(f,{type:"primary",onClick:N,class:"mb-8"},{default:s(()=>[Pe]),_:1}),a(f,{class:"mb-8",onClick:V},{default:s(()=>[je]),_:1})]),n("div",He,[a(f,{type:"primary",onClick:e[9]||(e[9]=l=>I(A).pushByPath("/warehouse/form"))},{default:s(()=>[We,Me]),_:1}),a(f,{type:"info",onClick:r},{default:s(()=>[Fe,Ke]),_:1}),a(f,{type:"info",onClick:P},{default:s(()=>[Qe,Xe]),_:1}),a(f,{type:"primary",onClick:B,disabled:v.value.length===0},{default:s(()=>[qe]),_:1},8,["disabled"]),a(f,{type:"danger",onClick:B,disabled:v.value.length===0},{default:s(()=>[Ge]),_:1},8,["disabled"])]),a(Be,{ref_key:"employeesTableRef",ref:y,items:h.listData,onRefresh:g,onSelect:i},null,8,["items"]),n("div",Je,[a(re,{"current-page":t.value.page,"onUpdate:currentPage":e[10]||(e[10]=l=>t.value.page=l),"page-size":t.value.pageSize,"onUpdate:pageSize":e[11]||(e[11]=l=>t.value.pageSize=l),total:h.totals,onCurrentChange:g,onSizeChange:N},null,8,["current-page","page-size","total"])])])]),_:1}),a(I(de),{ref_key:"modalImportRef",ref:d,onConfirm:C},null,512),a(I(Y),{ref_key:"modalConfirmRef",ref:T,onConfirm:u},null,512)],64)}}});const kt=O(Oe,[["__scopeId","data-v-9c39b5fc"]]);export{kt as default};
